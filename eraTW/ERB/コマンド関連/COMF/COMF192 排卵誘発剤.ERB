;-------------------------------------------------
;排卵诱发剂
;特殊指令
;-------------------------------------------------
@COM192
IF TCVAR:强制排卵
	PRINTL 已经服用完毕
	RETURN -1
ENDIF
ITEM:排卵诱发剂 -= 1
TCVAR:强制排卵 = 180
;-------------------------------------------------
;COM别FLAGの设定
;-------------------------------------------------
;行为者
TCVAR:116 = PLAYER
;-------------------------------------------------
;ソース追加处理
;-------------------------------------------------
;消费体力、气力
IF FLAG:70 == 1

ELSE

;调教者が调合知识を持っていれば消费を抑えられる
IF TALENT:PLAYER:调合知识
	DOWNBASE:体力 += 200
	DOWNBASE:气力 += 200
ELSE
	DOWNBASE:体力 += 100
	DOWNBASE:气力 += 100
ENDIF
	SOURCE:偏离正轨 = 1000
ENDIF

;-------------------------------------------------
;経験の处理
;-------------------------------------------------
;同性爱　レズなら返回值1ゲイなら返回值2
IF FLAG:70 == 1
	IF HETEROSEX(TARGET,PLAYER)
		EXP:PLAYER:(50 + HETEROSEX(TARGET,PLAYER)) += 1
	ENDIF
ELSE
	IF HETEROSEX(TARGET,PLAYER)
		EXP:(50 + HETEROSEX(TARGET,PLAYER)) += 1
		EXP:PLAYER:(50 + HETEROSEX(TARGET,PLAYER)) += 1
	ENDIF
ENDIF
RETURN 1

@CAN_COM192(ARG)
SKIPDISP ARG
;-------------------------------------------------
;实行判定处理
;-------------------------------------------------
IF FLAG:70 == 1 || CFLAG:恶作剧

ELSE
A = 0
S = 0

;全部の命令に共通の要素を考虑
;(顺从が高いと命令に从いやすいなど)
CALL COM_ORDER

;ABL:欲望
IF ABL:欲望
	SIF S
		PRINT  + 
	A += ABL:欲望 * 1
	PRINT 欲望
	PRINTV 'LV,ABL:欲望,'(,ABL:欲望 * 1,')
	S = 1
ENDIF
;ABL:Ｖ感觉
IF ABL:Ｖ感觉
	SIF S
		PRINT  + 
	A += ABL:Ｖ感觉 * 2
	PRINT Ｖ感觉
	PRINTV 'LV,ABL:Ｖ感觉,'(,ABL:Ｖ感觉 * 2,')
	S = 1
ENDIF
;ABL:精液中毒
IF ABL:精液中毒
	SIF S
		PRINT  + 
	A += ABL:精液中毒 * 3
	PRINT 精液中毒
	PRINTV 'LV,ABL:精液中毒,'(,ABL:精液中毒 * 3,')
	S = 1
ENDIF

IF MARK:快乐刻印
	SIF S
		PRINT  + 
	A += MARK:快乐刻印 * 1
	PRINT 快乐刻印
	PRINTV 'LV,MARK:快乐刻印,'(,MARK:快乐刻印 * 1,')
	S = 1
ENDIF
;PALAM:情欲
IF GETPALAMLV(PALAM:情欲,5)
	SIF S
		PRINT  + 
	A += GETPALAMLV(PALAM:情欲,5) * 1
	PRINT 情欲
	PRINTV 'LV,GETPALAMLV(PALAM:情欲,5),'(,GETPALAMLV(PALAM:情欲,5) * 1,')
	S = 1
ENDIF
;害羞
IF TALENT:羞耻心 > 0
	PRINT  - 
	A -= 1
	PRINT 害羞
	PRINTV '(,1,')
	S = 1
ENDIF
;讨厌男人（恋慕、亲爱で无效）
IF OTOKOGIRAI(TARGET)
	PRINT  - 
	A -= 12
	PRINT 讨厌男人
	PRINTV '(,12,')
	S = 1
ENDIF
;恋慕
IF TALENT:恋慕 && ASSIPLAY == 0
	SIF S
		PRINT  + 
	A += 5
	PRINT 恋慕
	PRINTV '(,5,')
	S = 5
ENDIF
;爱欲
IF TALENT:爱欲 && ASSIPLAY == 0
	SIF S
		PRINT  + 
	A += 5
	PRINT 爱欲
	PRINTV '(,5,')
	S = 5
ENDIF
;亲爱
IF TALENT:恋慕 > 1 && ASSIPLAY == 0
	SIF S
		PRINT  + 
	A += 5
	PRINT 亲爱
	PRINTV '(,5,')
	S = 5
ENDIF

;允许无套
IF CFLAG:允许无套 == 2
	SIF S
		PRINT  + 
	A += 5
	PRINT 同意中出
	PRINTV '(,5,')
	S = 1
ELSE
	SIF S
		PRINT  - 
	A -= 200
	PRINT 未同意中出
	PRINTV '(,200,')
	S = 1
ENDIF

;调教者が扶她
IF (TALENT:PLAYER:2 & 3) == 3
	SIF S
		PRINT  + 
	A += 8
	PRINT 扶她
	PRINTV '(,8,')
	S = 1
ENDIF

;合计を表示(100以上で实行)
PRINT  = 
PRINTV A

V = 100
SIF A < V
	PRINT  < 
SIF A == V
	PRINT  = 
SIF A > V
	PRINT  > 
PRINT 实行值
PRINTV V

WAIT
SKIPDISP 0
;实行できない
SIF A < V
	RETURN 0
ENDIF
RETURN 1

;-------------------------------------------------
;实行判定
;-------------------------------------------------
@COM_ABLE192
;排卵诱发剂实行判定
SIF !TFLAG:100
	RETURN 0
;批量管理
SIF GLOBAL_COMABLE(192)
	RETURN RESULT
;道具を持っていないとダメ
SIF ITEM:排卵诱发剂 == 0
	RETURN 0
IF DRUG == 0
	;药毒耐性だとダメ
	SIF TALENT:药毒耐性
		RETURN 0
	;停止中は不可
	SIF FLAG:70 == 1
		RETURN 0
ENDIF
SIF SHIRAHU(TARGET) && CFLAG:允许无套 != 2
	RETURN 0
RETURN 1

