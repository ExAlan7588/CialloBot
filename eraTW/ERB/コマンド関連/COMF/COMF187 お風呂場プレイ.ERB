;-------------------------------------------------
;浴室PLAY
;特殊な指令
;-------------------------------------------------
@COM187
;着脱の处理　结束时はソース、経験の加算は行わない
IF TEQUIP:浴室PLAY == 1
	TEQUIP:浴室PLAY = 0
	;淋浴も外す
	TEQUIP:淋浴 = 0
	RETURN 1
ELSE
	TEQUIP:浴室PLAY = 1
ENDIF
;-------------------------------------------------
;COM别FLAGの设定
;-------------------------------------------------
;行为者
TCVAR:116 = PLAYER
;-------------------------------------------------
;ソース追加处理
;-------------------------------------------------
;消费体力、气力
DOWNBASE:体力 += 0
DOWNBASE:气力 += 30

SOURCE:恐怖 = 100
SOURCE:露出 = 200
SOURCE:偏离正轨 = 50
SOURCE:反感 = 100


;-------------------------------------------------
;特殊ソース处理
;-------------------------------------------------
;圧抑、抵抗持ちには、抑郁ソース追加
SIF TALENT:自己爱 < 0 || TALENT:抵抗
	SOURCE:郁闷 += 50
;-------------------------------------------------
;污れの处理
;-------------------------------------------------
;装备时に污れをリセットする（澡堂に来て污れたままもどうかということで）
STAIN:0 = 0
STAIN:1 = 0
STAIN:2 = 2
STAIN:3 = 1
STAIN:4 = 8
STAIN:5 = 0

RETURN 1
;-------------------------------------------------
;装着继续の处理
;-------------------------------------------------
@EQUIP_COM187(ARG)
;浴室PLAY
SIF ARG
	PRINTL ＜浴室PLAY中＞

IF FLAG:70 == 1

ELSE
	DOWNBASE:ARG:体力 += 10
	DOWNBASE:ARG:气力 += 10

	SOURCE:ARG:恭顺 += 100
	SOURCE:ARG:反感 += 50
ENDIF

RETURN 1

;-------------------------------------------------
;实行判定
;-------------------------------------------------
@COM_ABLE187
;浴室PLAY实行判定
SIF !TFLAG:100
	RETURN 0
;批量管理
SIF GLOBAL_COMABLE(187)
	RETURN RESULT
;解除是つでも可能
SIF TEQUIP:31
	RETURN 1
;顺从が1以上ないとダメ
SIF ABL:顺从 <= 1
	RETURN 0
;对象か助手が动物耳で、顺从が3以下だとダメ
SIF TALENT:动物耳 && ABL:顺从 <= 2
	RETURN 0
IF ASSI >= 0
	SIF TALENT:ASSI:动物耳 && ABL:顺从 <= 2
		RETURN 0
ENDIF
;简易泳池がないとダメ
SIF !ITEM:简易泳池
	RETURN 0
;待客室以外は温水机能がないとダメ
SIF !GETBIT (FLAG:泳池, 1) && CFLAG:MASTER:当前位置 != OMANEKIBEYA()
	RETURN 0
;;广くない场所はダメ,※广阔お澡堂は无い
;SIF !OPENPLACE(CFLAG:MASTER:当前位置)
;	RETURN 0
;全裸でないとダメ
SIF TEQUIP:0 || TEQUIP:1
	RETURN 0
;野外PLAY中はダメ
SIF TEQUIP:29
	RETURN 0
;羞耻PLAY中はダメ
SIF TEQUIP:30
	RETURN 0
;新妻PLAY中はダメ
IF NEWWIFE == 0
	SIF TEQUIP:33
		RETURN 0
ENDIF
;停止中は不可
SIF FLAG:70 == 1
	RETURN 0
RETURN 1

