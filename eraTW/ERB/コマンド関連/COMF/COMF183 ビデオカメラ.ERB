;-------------------------------------------------
;摄像机
;特殊指令
;-------------------------------------------------
@COM183

;摄影者の处理
$INPUT_LOOP
IF TEQUIP:MASTER:28 == 0
;	PRINTL 摄影者を选择してください　途中变更はできません
;	PRINTL （摄影者を变更する场合、一度摄影を结束してください）
;	PRINTL 
;	PRINTFORML [0] 固定照相机
;	PRINTFORML [1] %NAME_OUTPUT_TRANSLATION("CALLNAME", MASTER)%
;	SIF ASSI > 0
;	PRINTFORML [2] %NAME_OUTPUT_TRANSLATION("CALLNAME", ASSI)%
;	PRINTFORML 
;	INPUT
;	TFLAG:105 = RESULT
;	IF RESULT == 0
;		PRINTFORML 照相机を固定して摄影します
;	ELSEIF RESULT == 1
;		PRINTFORML 摄影者は%NAME_OUTPUT_TRANSLATION("CALLNAME", MASTER)%です
;	ELSEIF RESULT == 2 && ASSI > 0
;		PRINTFORML 摄影者は%NAME_OUTPUT_TRANSLATION("CALLNAME", ASSI)%です
;	ELSE
;		GOTO INPUT_LOOP
;	ENDIF
	;录像带
	ITEM:43 --
	;自动补充
	IF !ITEM:43 && MONEY >= 500 && FLAG:1001
		MONEY -= 500
		ITEM:43 ++
	ENDIF
ENDIF


;着脱の处理
IF TEQUIP:MASTER:视频拍摄
;视频拍摄がされていれば结束させる
	TEQUIP:MASTER:视频拍摄 = 0
	PRINTW ★★★视频摄影结束了★★★
ELSE
;视频拍摄してなければ初期化して开始
;TODO 启动条件を作成する
	TEQUIP:MASTER:视频拍摄 = 11
	TSTR:1 = /
	PRINTW ★★★视频摄影开始了★★★
ENDIF
;-------------------------------------------------
;COM别FLAGの设定
;-------------------------------------------------
;行为者
TCVAR:116 = PLAYER

RETURN 1
;-------------------------------------------------
;装着继续の处理
;-------------------------------------------------
@EQUIP_COM183(ARG)
;摄影开始时はカウントに入れない

;-------------------------------------------------
;ソース追加处理
;-------------------------------------------------
;消费体力、气力
DOWNBASE:ARG:体力 += 0
DOWNBASE:ARG:气力 += 50

SOURCE:ARG:恐怖 += 1000
SOURCE:ARG:偏离正轨 += 400
SOURCE:ARG:反感 += 700


;-------------------------------------------------
;特殊ソース处理
;-------------------------------------------------
;圧抑、抵抗持ちには、抑郁ソース追加
SIF TALENT:ARG:自己爱 < 0 || TALENT:ARG:抵抗
	SOURCE:ARG:郁闷 += 700

;苦痛を伴わない受虐属性及び受虐狂の处理は先にしておく
;受虐属性を见る
LOCAL = 1000
SELECTCASE ABL:ARG:受虐属性
	CASE 0
		TIMES LOCAL , 0.80
		SOURCE:ARG:液体 += 0
		SOURCE:ARG:情欲 += 0
	CASE 1
		TIMES LOCAL , 1.00
		SOURCE:ARG:液体 += 20
		SOURCE:ARG:情欲 += 30
	CASE 2
		TIMES LOCAL , 1.20
		SOURCE:ARG:液体 += 40
		SOURCE:ARG:情欲 += 70
	CASE 3
		TIMES LOCAL , 1.40
		SOURCE:ARG:液体 += 70
		SOURCE:ARG:情欲 += 120
	CASE 4
		TIMES LOCAL , 1.50
		SOURCE:ARG:液体 += 110
		SOURCE:ARG:情欲 += 180
	CASE 5
		TIMES LOCAL , 1.70
		SOURCE:ARG:液体 += 150
		SOURCE:ARG:情欲 += 250
	CASE 6
		TIMES LOCAL , 1.90
		SOURCE:ARG:液体 += 200
		SOURCE:ARG:情欲 += 300
	CASE 7
		TIMES LOCAL , 2.10
		SOURCE:ARG:液体 += 250
		SOURCE:ARG:情欲 += 350
	CASE 8
		TIMES LOCAL , 2.30
		SOURCE:ARG:液体 += 300
		SOURCE:ARG:情欲 += 400
	CASE 9
		TIMES LOCAL , 2.50
		SOURCE:ARG:液体 += 350
		SOURCE:ARG:情欲 += 450
	CASEELSE
		TIMES LOCAL , 3.00
		SOURCE:ARG:液体 += 500
		SOURCE:ARG:情欲 += 500
ENDSELECT
SOURCE:ARG:露出 += LOCAL

;-------------------------------------------------
;ビデオの处理
;-------------------------------------------------
;摄影开始直后
SIF TEQUIP:MASTER:视频拍摄 == 11
	RETURN 1
LOCALS = {SELECTCOM}/
TSTR:1 += LOCALS
;-------------------------------------------------
;経験の处理
;-------------------------------------------------
;IF TFLAG:105 == 1
;	EXP:MASTER:摄影经验 += 1
;ELSEIF TFLAG:105 == 2
;	EXP:ASSI:摄影经验 += 1
;ENDIF
EXP:ARG:被拍照经验 += 1

RETURN 1

;-------------------------------------------------
;实行判定
;-------------------------------------------------
@COM_ABLE183
;视频拍摄实行判定
SIF !TFLAG:100
	RETURN 0
;批量管理
SIF GLOBAL_COMABLE(183)
	RETURN RESULT
;解除是つでも可能
SIF TEQUIP:28
	RETURN 1
;照相机とテープの道具を持っているか、道具无设定でないとダメ
SIF (ITEM:18 == 0 || ITEM:43 == 0) && NOITEM == 0
	RETURN 0
;停止中は不可
SIF FLAG:70 == 1
	RETURN 0
RETURN 1

