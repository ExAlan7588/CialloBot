;────────────────────────────────────
;爱抚、性交等の继续、解除、处理
;────────────────────────────────────
@SHOW_TOUCH
;(1=阴茎 2=阴蒂 3=指 4=口 5=胸 6=膣 7=肛门 8=足)
FOR LOCAL, 1, GET_TARGETNUM() + 1
	SIF TARGET:LOCAL <= 0
		CONTINUE
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｐ接触部位
		CASE 3
			PRINT 给对方手淫 
		CASE 4
			PRINT 给对方口交 
		CASE 6
			PRINT 逆强奸 
		CASE 7
			PRINT 逆肛交 
		CASE 8
			PRINT 给对方足交 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｃ接触部位
		CASE 1
			PRINT 素股 
		CASE 3
			PRINT 阴蒂爱抚 
		CASE 4
			PRINT 舐阴 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):指接触部位
		CASE 1
			PRINT 手淫 
		CASE 5
			PRINT 揉胸あい 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):口接触部位
		CASE 1
			PRINT 口交 
		CASE 2
			PRINT 舐阴させる 
		CASE 4
			PRINT 接吻 
		CASE 7
			PRINT 肛门侍奉 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｂ接触部位
		CASE 1
			PRINT 乳交 
		CASE 3
			PRINT 胸爱抚 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ｖ接触部位
		CASE 1
			PRINT 性交 
		CASE 3
			PRINT 指插入 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):Ａ接触部位
		CASE 1
			PRINT 肛门性交 
		CASE 3
			PRINT 肛门爱抚 
		CASE 4
			PRINT 舐肛 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):足接触部位
		CASE 1
			PRINT 足交 
	ENDSELECT
	PRINTFORML (%NAME_OUTPUT_TRANSLATION("CALLNAME", (TARGET:LOCAL))%)
NEXT
PRINTL

@TOUCH_SUCCESSION(ARG)
VARSET LOCAL
SELECTCASE SELECTCOM
	;爱抚　指と口をリセット
	CASE 0
		CALL TOUCH_RESET_M(SET_YUBI)
		SIF !TEQUIP:ARG:继续接吻
			CALL TOUCH_RESET_M(SET_M)
		;本来は二部位同时だけど、システム的には一部位しか无理なので、苦肉の策
		IF !RAND:2
			CALL TOUCH_SET(SET_FROM_C,SET_YUBI,ARG)
		ELSE
			CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		ENDIF
	;舐阴　性交解除し对象のＣに口をセット
	CASE 1
		CALL 插入解除(ARG)
		CALL TOUCH_RESET_M(SET_YUBI)
		IF GETBIT(TALENT:ARG:性别,1)
			CALL TOUCH_SET(SET_FROM_P,SET_M,ARG)
		ELSE
			CALL TOUCH_SET(SET_FROM_C,SET_M,ARG)
		ENDIF
	;给对方口交　性交解除し对象のＣに口をセット
	CASE 2
		;性交解除
		CALL 插入解除(ARG)
		CALL TOUCH_SET(SET_FROM_P,SET_M,ARG)
	;手指插入
	CASE 3
		IF TEQUIP:ARG:振动棒
		;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			;指を对象のＶにセット
			CALL TOUCH_SET(SET_FROM_V,SET_YUBI,ARG)
		ENDIF
	;舐肛
	CASE 4
		;性交解除し口を对象のＡにセット
		CALL 插入解除(ARG)
		CALL TOUCH_RESET_M(SET_YUBI)
		CALL TOUCH_SET(SET_FROM_A,SET_M,ARG)
	;肛门爱抚
	CASE 5
		IF TEQUIP:ARG:肛用振动棒 || TEQUIP:ARG:后庭拉珠 || TEQUIP:ARG:浣肠
			;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			CALL TOUCH_SET(SET_FROM_A,SET_YUBI,ARG)
		ENDIF
	;胸爱抚
	CASE 6
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;玩弄乳头
	CASE 7
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;张开阴唇
	CASE 8
		IF TEQUIP:ARG:Ａ接触部位 == 1 && TEQUIP:ARG:体位 == 2
			TEQUIP:ARG:体位 = 1
		ELSEIF TEQUIP:ARG:Ａ接触部位 == 1 && TEQUIP:ARG:体位 == 5
			TEQUIP:ARG:体位 = 4
		ELSEIF TEQUIP:ARG:Ａ接触部位 != 1
			CALL TOUCH_RESET_T(ARG)
		ENDIF
	;自慰
	CASE 9
	;吸乳头
	CASE 10
		CALL TOUCH_SET(SET_FROM_B,SET_M,ARG)
;--------------------------------------
	CASE 11
		CALL TOUCH_SET(SET_FROM_B,SET_M,ARG)
;--------------------------------------
	;揉胸
	CASE 12
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;张开肛门
	CASE 13
		IF TEQUIP:ARG:Ｖ接触部位 == 1 && TEQUIP:ARG:体位 == 1
			TEQUIP:ARG:体位 = 2
		ELSEIF TEQUIP:ARG:Ｖ接触部位 == 1 && TEQUIP:ARG:体位 == 4
			TEQUIP:ARG:体位 = 5
		ELSEIF TEQUIP:ARG:Ｖ接触部位 != 1
			CALL TOUCH_RESET_T(ARG)
		ENDIF
	;阴蒂爱抚
	CASE 15
		;指を对象のＣにセット
		CALL TOUCH_SET(SET_FROM_C,SET_YUBI,ARG)
	;接吻
	CASE 19,20
		CALL TOUCH_SET(SET_FROM_M,SET_M,ARG)
	;什么也不做
	CASE 21
	;诱い受け
	CASE 22
	;跳蛋
	CASE 40
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;电动按摩棒
	CASE 41
		CALL TOUCH_SET(0,0,0,SET_P)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;阴蒂夹
	CASE 42
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;飞机杯
	CASE 43
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｐ接触部位 = 0
	;振动棒
	CASE 44
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｖ接触部位 = 0
	;肛用振动棒
	CASE 45
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ａ接触部位 = 0
	;后庭拉珠
	CASE 46
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ａ接触部位 = 0
	;乳头夹
	CASE 47
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｂ接触部位 = 0
	;搾乳机
	CASE 48
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:Ｂ接触部位 = 0
	;乳头跳蛋
	CASE 49
		CALL TOUCH_RESET_M(SET_YUBI)
	;正常位
	CASE 60
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 1
	;后背位
	CASE 61
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	;正常位肛交
	CASE 62
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 1
	;后背位肛交
	CASE 63, 323
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	;逆强奸
	CASE 64
		CALL TOUCH_SET(SET_FROM_P,SET_V,ARG,1)
		TEQUIP:MASTER:体位 = 3
	;骑乘位
	CASE 65
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 3
	;骑乘位肛交
	CASE 66
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 3
	;对面座位
	CASE 67
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 4
	;背面座位
	CASE 68
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		TEQUIP:ARG:体位 = 5
	;对面座位肛交
	CASE 69
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 4
	;背面座位肛交
	CASE 70
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		TEQUIP:ARG:体位 = 5
	;二穴插入
	CASE 71
		IF TEQUIP:ARG:Ｖ接触部位 == 1
			TEQUIP:ARG:Ａ接触部位 = 0
		ELSEIF TEQUIP:ARG:Ａ接触部位 == 1
			TEQUIP:ARG:Ｖ接触部位 = 0
		ENDIF
	;插入Ｇ点玩弄
	CASE 72
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG)
	;插入子宫
	CASE 73
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG)
	;玩弄Ｓ状结肠
	CASE 74
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG)
	;ＡＧスポ
	CASE 75
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG)
	;小人飞机杯
	CASE 79
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 6
	;手淫
	CASE 80
		CALL TOUCH_SET(SET_FROM_YUBI,SET_P,ARG)
	;口交
	CASE 81
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_M,SET_P,ARG)
	;乳交
	CASE 82
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_B,SET_P,ARG)
	;素股
	CASE 83
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_C,SET_P,ARG)
	;泡泡浴
	CASE 84
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(0,0,0,1)
	;足交
	CASE 85
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_LEG,SET_P,ARG)
	;真空口交
	CASE 88
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_M,SET_P,ARG)
	;被爱抚肛门
	CASE 90
		CALL TOUCH_SET(SET_FROM_YUBI,SET_A,ARG)
	;被舐肛门
	CASE 91
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_M,SET_A,ARG)
	;被Ａ正常位
	CASE 92
		CALL TOUCH_SET(SET_FROM_P,SET_A,ARG)
		TEQUIP:MASTER:体位 = 1
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｖ接触部位 = 0
	;被Ａ后背位
	CASE 93
		CALL TOUCH_SET(SET_FROM_P,SET_A,ARG)
		TEQUIP:MASTER:体位 = 2
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｖ接触部位 = 0
	;被Ａ骑乘位
	CASE 94
		CALL TOUCH_SET(SET_FROM_P,SET_A,ARG)
		TEQUIP:MASTER:体位 = 3
		TEQUIP:ARG:Ｃ接触部位 = 0
		TEQUIP:ARG:Ｖ接触部位 = 0
	;打屁股
	CASE 100
		CALL TOUCH_RESET_M(SET_YUBI)
	;鞭
	CASE 101
		CALL TOUCH_RESET_M(SET_YUBI)
	;蜡烛
	CASE 102
		CALL TOUCH_RESET_M(SET_YUBI)
	;针
	CASE 103
		CALL TOUCH_RESET_M(SET_YUBI)
	;眼罩
	CASE 104
		CALL TOUCH_RESET_M(SET_YUBI)
	;打胸部
	CASE 108
		CALL TOUCH_RESET_M(SET_YUBI)
	;强制舐阴
	CASE 120
		CALL TOUCH_SET(SET_FROM_M,SET_C,ARG)
	;磨镜
	CASE 121
		CALL TOUCH_SET(SET_FROM_C,SET_C,ARG)
	;给对方手淫
	CASE 124
		CALL TOUCH_SET(SET_FROM_P,SET_YUBI,ARG)
	;被爱抚
	CASE 125
		TEQUIP:ARG:指接触部位 = 0
		TEQUIP:ARG:口接触部位 = 0
	;互揉胸部
	CASE 126
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:ARG:指接触部位 = 0
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
		CALL TOUCH_SET(SET_FROM_YUBI,5,ARG)
	;被正常位
	CASE 130
		CALL TOUCH_SET(SET_FROM_P,SET_V,ARG,1)
		TEQUIP:MASTER:体位 = 1
	;被后背位
	CASE 131
		CALL TOUCH_SET(SET_FROM_P,SET_V,ARG,1)
		TEQUIP:MASTER:体位 = 2
	;被对面座位
	CASE 132
		CALL TOUCH_SET(SET_FROM_P,SET_V,ARG,1)
		TEQUIP:MASTER:体位 = 4
	;被背面座位
	CASE 133
		CALL TOUCH_SET(SET_FROM_P,SET_V,ARG,1)
		TEQUIP:MASTER:体位 = 5
	;深喉插入
	CASE 140
		CALL TOUCH_SET(SET_FROM_M,SET_P,ARG)
	;拳交
	CASE 141
		CALL TOUCH_SET(SET_FROM_V,SET_YUBI,ARG)
	;肛门拳交
	CASE 142
		CALL TOUCH_SET(SET_FROM_A,SET_YUBI,ARG)
	;两穴拳交
	CASE 143
		TEQUIP:MASTER:Ｖ接触部位 = 3
		TEQUIP:MASTER:Ａ接触部位 = 3
	;肛门侍奉
	CASE 145
		CALL TOUCH_SET(SET_FROM_M,SET_A,ARG)
	;浣肠
	CASE 146
		CALL TOUCH_RESET_M(SET_YUBI)
	;扩张气球
	CASE 147
		CALL TOUCH_RESET_M(SET_YUBI)
	;肛门电极
	CASE 148
		CALL TOUCH_RESET_M(SET_YUBI)
		CALL TOUCH_SET(SET_FROM_A,1,ARG)
	;乳を握り溃す
	CASE 149
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;双乳间抽插
	CASE 150
		CALL TOUCH_SET(SET_FROM_B,SET_P,ARG)

	;日常性骚扰
	;接吻
	CASE 312
		CALL TOUCH_SET(SET_FROM_M,SET_M,ARG)
	;胸爱抚
	CASE 313
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,ARG)
	;肛门爱抚
	CASE 314
		CALL TOUCH_SET(SET_FROM_A,SET_YUBI,ARG)
	;阴蒂爱抚
	CASE 315
		IF GETBIT(TALENT:ARG:性别,1)
			CALL TOUCH_SET(SET_FROM_P,SET_YUBI,ARG)
		ELSE
			CALL TOUCH_SET(SET_FROM_C,SET_YUBI,ARG)
		ENDIF
	;手指插入
	CASE 316
		CALL TOUCH_SET(SET_FROM_V,SET_YUBI,ARG)

	;对方主导正常位
	CASE 320
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 1
	;对方主导后背位
	CASE 322
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_V,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	;对方主导后背位Ａ
	CASE 323
		IF TEQUIP:ARG:Ｐ接触部位 == 6 || TEQUIP:ARG:Ｐ接触部位 == 7
			CALL 插入解除(ARG)
		ENDIF
		CALL TOUCH_SET(SET_FROM_A,SET_P,ARG,1)
		TEQUIP:ARG:体位 = 2
	
	;爱抚(慰)
	CASE 700
		CALL TOUCH_RESET_M(SET_YUBI)
	;自我口交(慰)
	CASE 702
		TEQUIP:MASTER:口接触部位 = 1
		TEQUIP:MASTER:Ｐ接触部位 = 4
	;手指插入(慰)
	CASE 703
		IF TEQUIP:ARG:振动棒
		;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			;指を对象のＶにセット
			CALL TOUCH_SET(SET_FROM_V,SET_YUBI,MASTER)
		ENDIF
	;肛门爱抚(慰)
	CASE 705
		IF TEQUIP:ARG:肛用振动棒 || TEQUIP:ARG:后庭拉珠 || TEQUIP:ARG:浣肠
			;指リセット
			CALL TOUCH_RESET_M(SET_YUBI)
		ELSE
			CALL TOUCH_SET(SET_FROM_A,SET_YUBI,MASTER)
		ENDIF
	;胸爱抚(慰)
	CASE 706
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,MASTER)
	;玩弄乳头(慰)
	CASE 707
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,MASTER)
	;张开阴唇(慰)
	CASE 708
		CALL TOUCH_RESET_T(MASTER)
	;手淫(慰)
	CASE 709
		CALL TOUCH_SET(SET_FROM_P,SET_YUBI,MASTER)
	;揉胸(慰)
	CASE 712
		CALL TOUCH_SET(SET_FROM_B,SET_YUBI,MASTER)
	;张开肛门(慰)
	CASE 713
		CALL TOUCH_RESET_T(MASTER)
	;跳蛋(慰)
	CASE 740
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;电动按摩棒(慰)
	CASE 741
		CALL TOUCH_SET(0,0,0,1)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;阴蒂夹(慰)
	CASE 742
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;飞机杯(慰)
	CASE 743
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｃ接触部位 = 0
		TEQUIP:MASTER:Ｐ接触部位 = 0
	;振动棒(慰)
	CASE 744
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｖ接触部位 = 0
	;肛用振动棒(慰)
	CASE 745
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ａ接触部位 = 0
	;后庭拉珠(慰)
	CASE 746
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ａ接触部位 = 0
	;乳头夹(慰)
	CASE 747
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｂ接触部位 = 0
	;搾乳机(慰)
	CASE 748
		CALL TOUCH_RESET_M(SET_YUBI)
		TEQUIP:MASTER:Ｂ接触部位 = 0
	;乳头跳蛋(慰)
	CASE 749

	CASE IS < 200
		CALL TOUCH_SET(0,0,0,1)
	CASE IS > 500
		CALL TOUCH_SET(0,0,0,1)
	;扫除
	CASE 410
		CALL TOUCH_SET(0,0,0,1)
	CASE 778
		CALL TOUCH_SET(0,0,0,1)
ENDSELECT


;MASTERとTARGETの接触部位を设定する
@TOUCH_SET(ARG,ARG:1,ARG:2,ARG:3)
;ARG TARGETの接触部位(101=阴茎 102=阴蒂 103=指 104=口 105=胸 106=膣 107=肛门 108=足)
;ARG:1 MASTERの接触部位(1=阴茎 2=阴蒂 3=指 4=口 5=胸 6=膣 7=肛门 8=足)
;ARG:2 对象の角色番号
;ARG:3 真ならリセットする
VARSET LOCAL

IF ARG:3
	FOR LOCAL,1,CHARANUM
		FOR LOCAL:1,1,9
		;COM60~70の场合、口はリセットしない
			SIF LOCAL == ARG:2 && LOCAL:1 == 4 && TFLAG:3 >= 60 && TFLAG:3 <= 70
				CONTINUE
			TEQUIP:LOCAL:(100 + LOCAL:1) = 0
		NEXT
		;ついでに体位もリセット
		TEQUIP:LOCAL:体位 = 0
	NEXT
ENDIF
SIF ARG <= 100
	RETURN 0
FOR LOCAL,1,CHARANUM
	FOR LOCAL:1,1,9
		SIF TEQUIP:LOCAL:(100 + LOCAL:1) == ARG:1
			TEQUIP:LOCAL:(100 + LOCAL:1) = 0
	NEXT
NEXT
TEQUIP:(ARG:2):ARG = ARG:1
;继续系指令を解除

IF MASTER_POSE(SET_M,SET_M) != ARG:2 && TEQUIP:(ARG:2):继续接吻 && SELECTCOM != 0
	FOR LOCAL,1,CHARANUM
		TEQUIP:LOCAL:继续接吻 = 0
	NEXT
	PRINTL ＜接吻解除＞
ENDIF

IF MASTER_POSE(SET_B,SET_YUBI) != ARG:2 && TEQUIP:(ARG:2):揉胸
	FOR LOCAL,1,CHARANUM
		TEQUIP:LOCAL:揉胸 = 0
	NEXT
	PRINTL ＜揉胸解除＞
ENDIF

IF MASTER_POSE(SET_B,SET_M) != ARG:2 && TEQUIP:(ARG:2):吸乳头 && SELECTCOM != 6 && SELECTCOM != 12
	FOR LOCAL,1,CHARANUM
		TEQUIP:LOCAL:吸乳头 = 0
	NEXT
	PRINTL ＜吸乳头解除＞
ENDIF


;MASTERの接触部位をリセットする
@TOUCH_RESET_M(ARG)
;ARG MASTERの接触部位(1=阴茎 2=阴蒂 3=指 4=口 5=胸 6=膣 7=肛门 8=足)
FOR LOCAL, 1, GET_TARGETNUM() + 1
	SIF TARGET:LOCAL <= 0
		CONTINUE
	FOR LOCAL:1,1,9
		SIF TEQUIP:(TARGET:LOCAL):(100 + LOCAL:1) == ARG
				TEQUIP:(TARGET:LOCAL):(100 + LOCAL:1) = 0
	NEXT
NEXT

;TARGETの接触部位をリセットする
@TOUCH_RESET_T(ARG)
FOR LOCAL,1,9
	TEQUIP:ARG:(100 + LOCAL) = 0
NEXT
SIF TEQUIP:ARG:体位 > 0
	TEQUIP:ARG:体位 = 0
SIF TEQUIP:MASTER:体位 > 0
	TEQUIP:MASTER:体位 = 0
@MASTER_POSE(ARG,ARG:1,ARG:2)
;ARG MASTERの部位を占有中のTARGET:Xの部位(1=阴茎 2=阴蒂 3=指 4=口 5=胸 6=膣 7=肛门 8=足)
;ARG 0なら谁が占有しているか返す
;ARG:1 MASTERの部位(1=阴茎 2=阴蒂 3=指 4=口 5=胸 6=膣 7=肛门 8=足)
;ARG:2 真なら前ターンの履历を见る
;返回值 MASTERの部位を占有中のTARGET:Xがいるならその角色番号を返す
;MASTER_POSE(SET_M,SET_P,1)なら前ターン(第3参数)に谁かがMASTERの阴茎(第2参数)を口(第1参数)で占有していた场合、その角色番号を返す
;ARGでMASTERのARG:1に触れている角色を返すってこと
#FUNCTION
VARSET LOCAL
IF !ARG
	FOR LOCAL,1,CHARANUM
		SIF CFLAG:LOCAL:当前位置 != CFLAG:MASTER:当前位置
			CONTINUE
		FOR LOCAL:1,1,9
			SIF TEQUIP:LOCAL:(100 + LOCAL:1) == ARG:1
				RETURNF LOCAL
		NEXT
	NEXT
ENDIF
ARG:2 = ARG:2 ? 1 # 0
FOR LOCAL, 1, GET_TARGETNUM() + 1
	SIF TARGET:LOCAL <= 0
		CONTINUE
	SIF TEQUIP:(TARGET:LOCAL):(100 + ARG + 10 * ARG:2) == ARG:1
		RETURNF TARGET:LOCAL
NEXT

@插入解除(ARG)
SIF TEQUIP:ARG:Ｖ接触部位 == 1
	TEQUIP:ARG:Ｖ接触部位 = 0
SIF TEQUIP:ARG:Ａ接触部位 == 1
	TEQUIP:ARG:Ａ接触部位 = 0
TEQUIP:ARG:Ｃ接触部位 = 0
TEQUIP:ARG:Ｐ接触部位 = 0
TEQUIP:ARG:口接触部位 = 0
TEQUIP:ARG:Ｖ性交 = -1
TEQUIP:ARG:Ａ性交 = -1
TEQUIP:ARG:体位 = 0
TCVAR:ARG:误爆插入フラグ = 0
