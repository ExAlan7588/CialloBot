@CHARAMOVE_DATA_158(ARG, ARG:2)
LOCAL = 158
SELECTCASE ARG
	;连动设定（RETURN=依存するキャラ, RESULT:1～3=对等に连动するキャラ）
	CASE 1
	;特殊生活时间设定（CFLAG:LOCAL:生活时间补正を设定する）
	CASE 3
	;移动倾向（±～10=行きやすい/行きにくい, -100=行かない）
	CASE 4
		SELECTCASE ARG:2
			;Why would she return to the place she broke out of?
			CASE P901地灵殿前 TO P948竖井底部
				RETURN -100
			;Not gonna return to the scenes of her crimes (Myouren Temple, SDM, Eientei, Mokou's House, Hakugyokurou, areas Nitori and Hina frequent, Moriya Shrine)
			CASE P101山门 TO P140地藏小路, P301正门 TO P348雾之湖・湖底, P401永远亭入口 TO P430地下室, P445妹红的家, P621庭 TO P629西行妖, P703玄武之泽 TO P706厄神的家, P811境内 TO P826走廊
				RETURN -100
			;Not likely to confront Reimu directly, but might taunt her if she thinks she can get away with it
			CASE P1鸟居 TO P56阿吽的小屋
				RETURN -10
			;Interested in seeing what other food the surface has
			CASE P211酒屋, P212咖啡馆, P216食料品店 TO P218小料理屋
				RETURN 5
		ENDSELECT
	;出现场所
	CASE 7
		SELECTCASE ARG:2
			;Restaurant district
			CASE 吞屋小道
				RETURN 1
			;Possessing Marisa and stealing her magic items would help her get revenge
			CASE 雾雨魔法店
				RETURN 1
			;Might try to recruit other disgruntled spirits
			CASE 畜生界, 灵长园
				RETURN 1
		ENDSELECT
	;引力设定（CFLAG:LOCAL:引力点を设定する）
	CASE 8
ENDSELECT

@EXIST_キャラデータ158
#LOCALSIZE 1
#LOCALSSIZE 1

@キャラデータ158(ARG, O_DATA, V_NAME)
#FUNCTION
#LOCALSIZE 1
#LOCALSSIZE 1
#DIMS O_DATA
#DIMS V_NAME
SELECTCASE O_DATA
CASE "称呼"
	CALLF MAKE_STR(V_NAME, "瑞灵")
;こっから衣装设定
CASE "今天的睡衣"
	CALLF MAKE_STR(V_NAME, "睡衣（裤子）套")
CASE "便装：裙子"
	CALLF MAKE_INT(V_NAME, CLOTHES_ID("裙子", "囚人裙子"))
CASE "便装：上身衣服２"
	CALLF MAKE_INT(V_NAME, CLOTHES_ID("上身衣服２", "囚人シャツ"))

CASE "便装：饰品"
	CALLF MAKE_INT(V_NAME, CLOTHES_ID("饰品", "手铐"))
CASE "固有内衣形容词"
	CALLF MAKE_STR(V_NAME, "黑と白の縞模样")
CASE "固有下半身内衣名"
	CALLF MAKE_STR(V_NAME, "囚人のパンツ")
CASE "固有上半身内衣"
	CALLF MAKE_INT(V_NAME, 1)
CASE "固有上半身内衣名"
	CALLF MAKE_STR(V_NAME, "漆黑のキャミソール")
CASE "固有内衣着用条件"
	CALLF MAKE_INT(V_NAME, 1)
CASE "固有内衣半透明(前)"
	CALLF MAKE_INT(V_NAME, 1)
CASE "固有内衣半透明(后)"
	CALLF MAKE_INT(V_NAME, 1)
CASE "固有内衣布料厚度"
	CALLF MAKE_INT(V_NAME, 1)

;料理关联
CASE "料理：喜欢的味道"
	CALLF MAKE_STR(V_NAME, "香料/肉料理/和风/汁物/咸/豪华/上品/豪快/辣/辣/辣/玉兔流/谜料理/")
CASE "料理：讨厌的味道"
	CALLF MAKE_STR(V_NAME, "中华/甜/丰盛/浓厚/朴素/魔界风/魔界风/魔界风/天狗流/简易/清淡/")
CASE "料理：助手效果"
	CALLF MAKE_STR(V_NAME, "怪しい/" * 2)
;赠り物关联
CASE "感性：好き"
	CALLF MAKE_STR(V_NAME, "黑/妖怪/可怕的/知的/" + "幽灵/魔法/暗/怀旧/混沌/法具/传来の/" * 3 + "暗の/机力の/" * 5 + "渴血の/杀意の/" * 10)
CASE "感性：嫌い"
	CALLF MAKE_STR(V_NAME, "未来/异国风の/神灵/" + "护符/靴/封呪の/" * 3 + "妖怪の/地灵の/废狱の/地底の/" * 5 + "巫女の/博灵の/愤怒の/退魔の/" * 10)
ENDSELECT

;-------------------------------------------------
;固有料理设定
;DISH_NAME          料理名
;RESULTS            料理の种类（轻食/主食/デザート）
;CALL 材料设定("")  材料の指定。"泛用"を入れると自动で泛用食材になる
;DISH_TASTE         味の设定
;DISH_COMMENT       （任意）一行コメント
;DISH_TIME          （任意）调理にかかる时间
;DISH_MAXLIMIT      （任意）料理の持续时间
;-------------------------------------------------
@SPECIAL_MENU_158
DISH_NAME = 河豚皮肝拌饭
RESULTS = 轻食
CALL 材料设定("鱼")
DISH_TASTE = 和食/松脆/冷/刺激的/甜/
DISH_COMMENT = 用大师的技艺处理过的河豚肝和皮。完美地去除了有毒部分…大概吧？
RETURN 1

;********************************************************************************************
;キャラ别画像表示テンプレ IMAGE_I158_○○.ERB
;2020/11/07 画像表示修正パッチv2.0 版
;制作者		:画像修正パッチの人
;Licence	:ライセンスフリー(CC0)
;
;キャラ特有の表情やエフェクト画像を个别に表示できるようにしたもの。
;使用方法は ERB\ステータス表示关联\キャラ别画像表示 フォルダにある他キャラのファイルを参照してください。
;使用时は"XX"をキャラクター番号に全置换すること。
;********************************************************************************************
;IMAGE_I158_特殊服装(CHARA)-------------------------------------------------------------------
;キャラクター特有の服装表示条件
;エフェクトを共有する服装差分はこちらで指定する
;使用时注意点:
;	RESULTSに特殊服装を格纳すること
;	书式は %服装%%特殊服装% 适宜"_"等入れること
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊服装(CHARA)
#DIM CHARA
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF CHECK_NUDE(CHARA)
		;裸
		IF FLAG:立绘种类
			;颜绘
		ELSE
			;立绘
		ENDIF
	ELSE
		;服
		IF FLAG:立绘种类
			;颜绘
		ELSE
			;立绘
		ENDIF
	ENDIF
ELSE
	;通常画像
	IF CHECK_NUDE(CHARA)
		;裸
		IF FLAG:立绘种类
			;颜绘
		ELSE
			;立绘
		ENDIF
	ELSE
		;服
		IF CFLAG:CHARA:衣物暂时更换 == 55 || (CFLAG:CHARA:基本服装SET == 55 && CFLAG:CHARA:衣物暂时更换==0)
			IF FLAG:立绘种类
				;颜绘
				RESULTS = _バニー
			ELSE
				;立绘
				RESULTS = _バニー
			ENDIF
		ENDIF
	ENDIF
ENDIF

;IMAGE_I158_体形(CHARA)-----------------------------------------------------------------------
;キャラクター特有の体形表示条件
;エフェクトを共有する体形差分はこちら
;服装を指定しても自动で表示されるので注意
;使用时注意点:
;	RESULTSに体形を格纳すること
;	书式は %体形%%服装% 适宜"_"等入れること
;	"巨乳"は本编で实装済み %体形%巨乳%服装% で追记可能
;-------------------------------------------------------------------------------------------
@IMAGE_I158_体形(CHARA)
#DIM CHARA
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_特殊表情(CHARA)--------------------------------------------------------------------
;キャラクター特有の表情表示条件
;时间停止中でも维持する表情はこちら
;使用时注意点:
;	RESULTS:0に表情を格纳
;	RESULTS:1にマウスオーバー时の表情を格纳すること
;	"通常","笑颜","愤怒","发情","睡眠"は本编で实装済み
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊表情(CHARA)
#DIM CHARA
#DIM CLIMAX_EXHAUST ;gets stale after seeing it for a while, so spice it up a little

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
		IF FLAG:时间停止
			IF IN_HEAT(CHARA) && (CFLAG:CHARA:既成事实 && 合意_诶嘿嘿) && !CHECK_NUDE(CHARA)
				RESULTS:1 = 发情通常
			ELSEIF CHECK_NUDE(CHARA)
				RESULTS:1 '= @"%RESULTS:0%TIMESTOP"
				SIF IN_HEAT(CHARA) && (CFLAG:CHARA:既成事实 && 合意_诶嘿嘿)
					RESULTS:1 = 发情通常TIMESTOP
			ENDIF
		ELSEIF CFLAG:CHARA:睡眠 ;prevents overlapping status breaking the sprite
			RESULTS:0 = 睡眠
			RESULTS:1 = 睡眠
		;This check doesn't work, lame
		;Had to copy the checks here
		;ELSEIF RESULTS:0 == "爱抚" || RESULTS:0 == "性交"
		ELSE
			IF IN_HEAT(CHARA)
				IF !CHECK_NUDE(CHARA) && !IS_SEXING(CHARA) && (CFLAG:CHARA:既成事实 && 合意_诶嘿嘿)
					RESULTS:1 = 发情通常
				ELSE
					SELECTCASE SELECTCOM
						CASE 0 TO 15
							RESULTS:0 = 发情
							RESULTS:1 '= @"发情爱抚{RAND:2}"
						CASE 60 TO 79, 317 TO 323
							RESULTS:0 = 发情
							RESULTS:1 = 发情性交
					ENDSELECT
				ENDIF
			ELSE
				SELECTCASE SELECTCOM
					CASE 0 TO 15
						RESULTS:0 '= @"爱抚{RAND:3}"
					CASE 60 TO 79, 317 TO 323
						RESULTS:0 '= @"性交{RAND:3}"
					CASE 313 TO 316
						IF CFLAG:CHARA:诶嘿嘿
							RESULTS:0 = 爱抚
						ELSEIF MARK:CHARA:屈服刻印 == 3
							RESULTS:1 = 爱抚
						ENDIF
				ENDSELECT
			ENDIF
			IF NOWEX:TotalEX > 8 || NOWEX:时间停止TotalEX > 30 || MIN_ORGASM_STRENGTH(CHARA, 3)
				;This function triggers thrice
				;so CLIMAX_EXHAUST goes up by 3 every time this part is ran, what's even going on dude
				;numbers assigned to the CLIMAX_EXHAUST loop dont really have significant meaning to them
				SIF CLIMAX_EXHAUST < 6
					RESULTS:0 = 发情强绝顶
				CLIMAX_EXHAUST += RAND:8
				SIF CLIMAX_EXHAUST > 10
					CLIMAX_EXHAUST = 0
			ENDIF
		ENDIF

	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_特殊表情COM(CHARA, コマンド)-------------------------------------------------------
;直前のコマンドで变化するキャラクター特有の表情表示条件
;时间停止中は变化しない表情はこちら
;使用时注意点:
;	RESULTS:0に表情を格纳
;	RESULTS:1にマウスオーバー时の表情を格纳すること
;	"オナニー","爱抚","性交"は本编で实装済み
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊表情COM(CHARA, コマンド)
#DIM CHARA
#DIM コマンド

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_差分(CHARA)-----------------------------------------------------------------------
;キャラクター特有の差分表示条件
;裸やエフェクトを共有しない画像はこちら
;使用时注意点:
;	RESULTSに差分を格纳すること
;	书式は {CHARA}%差分% 适宜"_"等入れること
;-------------------------------------------------------------------------------------------
@IMAGE_I158_差分(CHARA)
#DIM CHARA
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_特殊照れ(CHARA)--------------------------------------------------------------------
;キャラクター特有の照れエフェクト表示条件
;使用时注意点:
;	RESULTSに特殊照れを格纳すること
;	书式は %特殊照れ%照れ
;	"裸"は本编で实装済み %特殊照れ%裸照れ で追记可能
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊照れ(CHARA)
#DIM CHARA
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_特殊吐息(CHARA)--------------------------------------------------------------------
;キャラクター特有の吐息エフェクト表示条件
;使用时注意点:
;	RESULTSに特殊吐息を格纳すること
;	书式は %特殊吐息%吐息
;	"裸"は本编で实装済み %特殊吐息%裸吐息 で追记可能
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊吐息(CHARA)
#DIM CHARA
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_特殊汗(CHARA)--------------------------------------------------------------------
;キャラクター特有の汗エフェクト表示条件
;使用时注意点:
;	RESULTSに特殊汗を格纳すること
;	书式は %特殊汗%汗
;	"裸"は本编で实装済み %特殊汗%裸汗 で追记可能
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊汗(CHARA)
#DIM CHARA
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

;IMAGE_I158_特殊エフェクトチェック(CHAR, エフェクト)--------------------------------------------
;キャラクター特有のエフェクト判定  特殊エフェクトを直接指定したい场合に参照
;参数 "エフェクト" に固有のエフェクトが含まれるかを判定する
;例の通り、STRFINDを使用してください
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊エフェクトチェック(CHARA, エフェクト)
#DIM CHARA
#DIMS エフェクト

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
ELSE
	;通常画像
	;SIF STRFIND(エフェクト, "母乳") != -1
	;	RETURN 1
	SIF STRFIND(エフェクト, "颜精液") != -1
		RETURN 1
	SIF STRFIND(エフェクト, "口精液") != -1
		RETURN 1
ENDIF

RETURN 0

;IMAGE_I158_特殊エフェクト(CHARA)--------------------------------------------------------------------
;キャラクター特有のエフェクト表示条件
;使用时注意点:
;	RESULTS配列に特殊エフェクトを格纳
;	RETURNで追加するエフェクト数を返还すること
;-------------------------------------------------------------------------------------------
@IMAGE_I158_特殊エフェクト(CHARA)
#DIM CHARA
#DIM DYNAMIC エフェクト数 = 0
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
		IF CFLAG:CHARA:脸上精液
			RESULTS:エフェクト数 = 颜精液
			エフェクト数 += 1
		ENDIF
		IF CFLAG:CHARA:口内精液
			RESULTS:エフェクト数 = 口精液
			エフェクト数 += 1
		ENDIF
	ELSE
		;立绘
	ENDIF
ENDIF

RETURN エフェクト数

;IMAGE_I158_自慰エフェクト(CHARA)--------------------------------------------------------------------
;キャラクター特有の自慰エフェクト表示条件
;使用时注意点:
;	RESULTS配列に自慰エフェクトを格纳
;	RETURNで追加するエフェクト数を返还すること
;-------------------------------------------------------------------------------------------
@IMAGE_I158_自慰エフェクト(CHARA)
#DIM CHARA
#DIM DYNAMIC エフェクト数 = 0
VARSET RESULTS

IF CFLAG:CHARA:应用差分替换
	;差し替え画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ELSE
	;通常画像
	IF FLAG:立绘种类
		;颜绘
	ELSE
		;立绘
	ENDIF
ENDIF

RETURN エフェクト数
