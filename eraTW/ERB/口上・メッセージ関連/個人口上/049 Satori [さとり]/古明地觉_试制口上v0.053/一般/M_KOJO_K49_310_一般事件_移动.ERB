;※※※※※※※※※※※※※※※※※※※※※※※※※※
;"EVENT"系イベント
;※※※※※※※※※※※※※※※※※※※※※※※※※※
@惩罚_310
IF CFLAG:49:当前位置==CFLAG:MASTER:当前位置
	PRINTFORML 「真是自寻死路啊」
	PRINTFORMW 「做了那种过分的事情还胆敢出现在我眼前」
	PRINTFORML 「被凌辱的羞愤，就让你亲自体会一下吧」
	PRINTFORMDW   头上宛如挨了一记闷棍，%CALLNAME:MASTER%失去了意识…
	BASE:MASTER:体力 = 0
	IF !GETBIT(TALENT:MASTER:性别 , 0)
		SETBIT TALENT:MASTER:性别 , 0
	ENDIF
	FOR LOCAL,14,65
		IF LOCAL <=17||LOCAL >=60
			EXP:MASTER:LOCAL +=20+RAND:50
		ENDIF
	NEXT
	TIME+=1440
	CFLAG:49:1504=504
	MARK:49:反抗刻印=MIN(MARK:49:反抗刻印+2,3)
	MARK:49:反抗取得履历=MIN(MARK:49:反抗取得履历+2,3)	
ENDIF

@惩罚_514
#DIM 角色
IF CFLAG:当前位置==CFLAG:MASTER:当前位置
	PRINTFORML 「果然是你干的啊」
	PRINTFORML 「对恋做了那么出格的事情，还想得到宽恕吗？」
	PRINTFORMW 「既然敢做，那就要敢当」
	PRINTFORMDL   %CALLNAME:MASTER%被触手死死缠住，动弹不得；
	PRINTFORMDW   被押到地灵殿门口，钉在了高处的一个凸起上。
	PRINTFORMDW   完全无法挣脱，%CALLNAME:MASTER%就这样一直被挂了一整天。
	PRINTFORMDL   其间还看见那个天狗记者来拍了好几张照片，是想取笑%CALLNAME:MASTER%的惨样吗？
	PRINTFORMDL   …后来%CALLNAME:MASTER%发现，从那以后总是有人在背后指指点点；
	PRINTFORMDW   发生了什么呀。
	FOR 角色,1,CHARANUM
		CFLAG:角色:好感度=MAX(CFLAG:角色:好感度-100,0)
		CFLAG:角色:信赖度=MAX(CFLAG:角色:信赖度-50,0)
		ABL:角色:亲密=MAX(ABL:角色:亲密-2,0)
		MARK:角色:反抗刻印=MIN(MARK:角色:反抗刻印+1,3)
		MARK:角色:反抗取得履历=MIN(MARK:角色:反抗取得履历+1,3)
	NEXT
	BASE:MASTER:体力 = 0
	BASE:MASTER:气力 = 0
	TIME+=1440
	MARK:38:反抗刻印=MIN(MARK:38:反抗刻印+1,3)
	MARK:38:反抗取得履历=MIN(MARK:38:反抗取得履历+1,3)
	CFLAG:38:1504=504
ENDIF
;==================================================
;房间で遭遇
;==================================================
@M_KOJO_NK_EVENT_K49_1(ARG,ARG:1)
#DIM CONST 无自觉奸=1504
;口上主はTARGET
;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 1
;-------------
IF LOCAL
	IF (EXP:睡眠奸经验+EXP:时奸经验>0 && !CFLAG:无自觉奸) && !GETBIT(CFLAG:既成事实 , 1)
		CALL 惩罚_310
	ELSEIF (EXP:38:睡眠奸经验+EXP:38:时奸经验>0 && !CFLAG:38:无自觉奸) && !GETBIT(CFLAG:38:既成事实 , 1)
		CALL 惩罚_514
	ENDIF
	;-------------------------------------------------
	;小分岐
	;-------------------------------------------------
	;MASTERが入ってきた
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 1
		CALL M_KOJO_NK_EVENT_K49_1_1
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;TARGETが入ってきた
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 2
		CALL M_KOJO_NK_EVENT_K49_1_1
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;TARGETが澡堂に入ってきて一绪に入る
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 3
		PRINTFORML
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;TARGETが澡堂に入ってきて出て行った
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 4
		PRINTFORML
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;TARGETが澡堂に入ってきて追い出された
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 5
		PRINTFORML
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;外出先で遭遇した
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 6
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;他キャラと约会中に遭遇した
	;ARG:1に约会的对象
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 7
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;MAIN_MAP上で一日最初の挨拶
	;注、このあと通常の遭遇口上、ARG==1 OR ARG==2に接续します
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 8
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;外出先で一日最初の挨拶
	;ARG:1に约会的对象、ARG:1が0の场合は非デート
	;注、このあと通常の外出先で遭遇した口上、ARG==6 OR ARG==7に接续します
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 9
		;ARG:1と约会中
		IF ARG:1
		;一人で外出
		ELSE
		ENDIF
		PRINTFORML 
		RETURN 1
	ENDIF
ENDIF
RETURN 1

@M_KOJO_NK_EVENT_K49_1_1

IF TARGET==49 && 关系_310()>0
	PRINTFORML 「是你啊」
	PRINTFORMDW   觉简单地打了个招呼。
ENDIF

;==================================================
;移动时すれちがい
;==================================================
@M_KOJO_NK_EVENT_K49_4(ARG,ARG:1)
;口上主はTARGET
;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 1
;-------------

IF LOCAL
	IF 关系_310()==0
		PRINTFORMDW   觉看到%CALLNAME:MASTER%出现在视野，马上扭过头去。
	ELSE
		;-------------------------------------------------
		;小分岐
		;-------------------------------------------------
		;立ち止まった
		;この后遭遇口上に接续
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1 && ARG == 1
			PRINTFORML 「嗯？有何贵干呢」
			PRINTFORMDW   觉抬眼看了%CALLNAME:MASTER%一会，就移开了视线。
			RETURN 1
		ENDIF
		;-------------------------------------------------
		;轻く会釈して通り过ぎた
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1 && ARG == 2
			PRINTFORML 「这样啊…」
			PRINTFORML 「快去忙你的吧」
			PRINTFORMDW   觉挥手告别。
			RETURN 1
		ENDIF
		;-------------------------------------------------
		;无视して通り过ぎた
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1 && ARG == 3
			PRINTFORMDW   觉没有任何反应，装作没看见%CALLNAME:MASTER%。
			RETURN 1
		ENDIF
	;その他
	;PRINTFORML 
	ENDIF 
ENDIF
RETURN 1

;==================================================
;浴场で遭遇
;==================================================
@M_KOJO_NK_EVENT_K49_11(ARG,ARG:1)
;口上主はTARGET
;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 0
;-------------

IF LOCAL
	;-------------------------------------------------
	;小分岐
	;-------------------------------------------------
	;追い出された
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 1
		PRINTFORML
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;目が合った（追い出されない）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 2
		PRINTFORML
		RETURN 1
	ENDIF
	;その他
	PRINTFORML  
ENDIF
RETURN 1

;==================================================
;回家时
;==================================================
@M_KOJO_NK_EVENT_K49_20(ARG,ARG:1)
;口上主はLOCALS or RESULT
;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 0
IF LOCAL
	;-------------------------------------------------
	;小分岐
	;-------------------------------------------------
	;通常回家
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 1
		IF CFLAG:诶嘿嘿
			;诶嘿嘿中に眠くて归る
			PRINTFORML 
		ELSE
			PRINTFORML 
		ENDIF
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;约会中回家
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 2
		IF CFLAG:诶嘿嘿
			IF CFLAG:衰弱
				;诶嘿嘿中に疲れて归る
				PRINTFORML 
			ELSE
				;诶嘿嘿中に眠くて归る
				PRINTFORML 
			ENDIF
		ELSE
			PRINTFORML 
		ENDIF
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;玄关先でお见送り（キャラの自宅位置、またはキャラの房间でデート结束）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 3
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;デート结束时に房间に来ないかと诱う（～から房间に来ないかと诱われた）
	;（来访キャラのみ,自宅が无いキャラでも发生します）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 4
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;房间に来ないか→「行く」を选择（～に诱われるまま、【MASTER】は【TARGET】の房间へと向かった……）
	;（これが发生すると十中八九押し倒されます）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 5
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;房间に来ないか→「やめとく」を选择（～は心なしか寂しそうだ……）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 6
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;今夜は归りたくないと言い出す（～は今夜は归りたくないと言い出した…）
	;（来访キャラの回家时に欲求不满と欲望が高いと发生）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 7
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;今夜は归りたくない→「泊める」を选择（～は【MASTERの自室】に泊まっていくことになりました）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 8
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;今夜は归りたくない→「泊めない」を选择、または家主が居る（【MASTER】は丁重に断った）
	;（家主が居る＝MASTERの私室に他のキャラの私室を设定している）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 9
		PRINTFORML 
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;疲れて回家（疲れきった～は归って行きました）
	;（～は疲れ切っている→（入り口）まで送るよ でも发生）
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 10
		IF CFLAG:诶嘿嘿
			;诶嘿嘿中に疲れて归る
			PRINTFORML 
		ELSE
			PRINTFORML 
		ENDIF
		RETURN 1
	ENDIF
ENDIF
RETURN 1

;==================================================
;浴场连れだし
;==================================================
@M_KOJO_NK_EVENT_K49_23(ARG,ARG:1)
;口上主はLOCAL
;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 0
;-------------
IF LOCAL
	;-------------------------------------------------
	;小分岐
	;-------------------------------------------------
	;断られた
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 1
		RETURN 1
	ENDIF
	;-------------------------------------------------
	;一绪に入ってくれた
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARG == 2
		RETURN 1
	ENDIF
	;その他
	PRINTFORML  
ENDIF
RETURN 1

;==================================================
;相手からデートのお诱い
;==================================================
@M_KOJO_NK_EVENT_K49_27(ARG,ARG:1)
;口上主はLOCAL
;ARG:1は目的地
;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 0
;-------------
IF LOCAL
	SELECTCASE ARG
		;-------------------------------------------------
		CASE 0
		;诱い文句
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1
			RETURN 1
		ENDIF
		;-------------------------------------------------
		CASE 1
		;受けた
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1
			RETURN 1
		ENDIF
		;-------------------------------------------------
		CASE 2
		;断った
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1
			RETURN 1
		ENDIF
		;-------------------------------------------------
		CASE 3
		;房间に诱われた
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1
			RETURN 1
		ENDIF
		;-------------------------------------------------
		CASE 4
		;房间に诱われたのを受けた
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1
			RETURN 1
		ENDIF
		;-------------------------------------------------
		CASE 5
		;房间に诱われたのを断った
		;记入チェック（=0, 非表示、1, 表示）
		LOCAL:1 = 1
		;-------------------------------------------------
		IF LOCAL:1
			RETURN 1
		ENDIF
	ENDSELECT
ENDIF
RETURN 1