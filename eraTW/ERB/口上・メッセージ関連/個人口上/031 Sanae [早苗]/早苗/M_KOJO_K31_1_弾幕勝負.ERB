;==================================================
;弹幕胜负
;==================================================
;
@M_KOJO_MESSAGE_COM_K31_DANMAKU(ARGS, 相手残机)
#DIM 相手残机
;全体の流れ
;①【战斗前】→②骰子ロールとプレイヤー选择肢、ハンデをつけた场合は【ハンデ口上】→③对応スキルが发动した场合【スキル口上】→④被弾判定、角色が被弾したなら【被弾口上】→
;どちらかの残机が0になっていなければ②に返回→⑤【战斗后口上】

;--------------------------------------------------
;记入チェック（=0, 非表示、1, 表示）
LOCAL = 1
;-------------
IF LOCAL
	SIF FLAG:口上色
		TRYCALLFORM M_KOJO_COLOR_K{NO:TARGET}
	;-------------------------------------------------
	;小分岐
	;-------------------------------------------------
	;战斗前
	HANDICAP_FIXED = 0
	HANDICAP_RAND = 0
	IF CFLAG:31:1001 == 4
		HANDICAP_FIXED = 200
	ELSE
		;什么也不做
	ENDIF
	;ハンデをつけることができ、数值が大きいほど你が不利になる　数值が负なら你が有利に
	;角色の能力に关わらずクッソ强くしたり弱くしたりできる
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "战斗前"
	
		CALL K31_特殊会话フラグの确认と出力("弹幕胜负")
		SIF RESULT
			RETURN 0
		
		PRINTFORML 「要比试吗？可以啊……但是受伤了可别怪我哦？ 我可是很强的！」
		PRINTFORML 「如果这样也好的话，我就接受挑战了，做好觉悟吧！」
		
		RETURN 0
	ENDIF
	;-------------------------------------------------
	;ハンデ
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "ハンデ"
		;ハンデつけなかったら表示されないので无记入でよい
		PRINTFORML ※这是事件战斗
		RETURN 0
	ENDIF
	;-------------------------------------------------
	;战斗中TARGET被弾时口上
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "被弾" 
		;别に一律で「やられたー」だけでもいいよ
		SELECTCASE 相手残机
			;残り残机3が表示されるのは【博览精思】持ちのみ
			CASE 3
				PRINTFORML 
			CASE 2
				PRINTFORML 「太大意了……！」
			CASE 1
				PRINTFORML 「怎么会，竟然……！」
			CASE 0
				PRINTFORML 「我竟然会输……！」
		ENDSELECT
	ENDIF
	;-------------------------------------------------
	;战斗中
	;TARGETの【残忍酷薄】发动时
	;ARGはTARGETの残机
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "残忍酷薄"
		
	ENDIF
	;-------------------------------------------------
	;战斗中
	;TARGETの【乾坤一掷】发动时
	;ARGはTARGETの残机
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "乾坤一掷"
		
	ENDIF
	;-------------------------------------------------
	;战斗中
	;TARGETの【怪力乱神】发动时
	;ARGはTARGETの残机
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 0
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "怪力乱神"
		
	ENDIF
	
	;-------------------------------------------------
	;战斗后
	;记入チェック（=0, 非表示、1, 表示）
	LOCAL:1 = 1
	;-------------------------------------------------
	IF LOCAL:1 && ARGS == "战斗后" 
		PRINTFORML 
		;残り残机4が表示されうるのは【博览精思】持ちのみ
		;残机が1以上なら你の负け、0の场合は你の胜利
		
		IF 相手残机 == 0 && CFLAG:31:1411 == 1
			;まさかの胜利
			CFLAG:31:1412 = 1
		ENDIF
		CALL K31_特殊会话フラグの确认と出力("弹幕胜负")
		
		SELECTCASE 相手残机
			CASE 4
				PRINTFORML 
			CASE 3
				PRINTFORML 「呵呵，随时都可以再陪你玩哦」
			CASE 2
				PRINTFORML 「稍微有点大意了，不过还是游刃有余♪」
			CASE 1
				PRINTFORML 「啊，危险……你好强啊，%CALLNAME:MASTER%先生…」
			CASE 0
				PRINTFORML 「我竟然会输……看来必须更加锻炼才行了……」
				CALL K31_MASTER逆转刻印取得チェック("削除")
		ENDSELECT
	ENDIF
RESETCOLOR
ENDIF
RETURN 1

