;==========================================================
;存在判定
;0だと日记は书かれません。
;==========================================================
@DIARY_NK_K38_EXIST
RETURN 1

;==========================================================
;常时チェックされる日记の状态情报
;简易版ではCHARAに番号を入れれば自动で处理してくれます
;==========================================================
@DIARY_NK_BEFORE_CHECK_K38
#DIM CHARA
CHARA = 38
MAX_DIARY_PAGE:CHARA:0 = 100
FOR LOCAL, 1, MAX_DIARY_PAGE:CHARA:0 + 1
	RESULT = 0
	TRYCALLFORM DIARY_K{CHARA}_{LOCAL}_HAPPEN
	IF RESULT
		IF !DIARY:CHARA:LOCAL || RESULT:2
			DIARY:CHARA:LOCAL = RESULT:1
			SIF RESULT:1 == 3
				CALL CHARA_DIARY_PAGESETTING(CHARA, LOCAL)
		ENDIF
	ENDIF
NEXT

;==========================================================
;デイリーイベントで日记が读まれた际の后处理。
;フラグの管理等自由に扱って良い。
;==========================================================
@DIARY_NK_AFTER_CHECK_K38

;==========================================================
;日记の内容
;PAGENUM   = 日记番号（日记のパターン）
;MODE      = "デイリー":一日结束时のデイリーイベントでの读み上げ
;          = "コマンド":[日记を读む]コマンドでの读み上げ
;PAGECOUNT = 何ページ目に书かれているか
;==========================================================
@DIARY_NK_TEXT_K38(PAGENUM, MODE, PAGECOUNT)
#DIM PAGENUM
#DIMS MODE
#DIM PAGECOUNT
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
;グループマッチに日记のIDを入れて、表示させたい颜绘を表示する
;表情・服装・特殊画像をオプション指定で表示（省略可）
;书式は\resources\颜.CSVと下の例を参照
;以下はサンプル
IF MODE == "デイリー"
	IF GROUPMATCH(PAGENUM, 1) 
		CALL PRINT_FACE, 38, "发情", "裸", "_1"
	ELSEIF GROUPMATCH(PAGENUM, 2)
		CALL PRINT_FACE, 38, "笑颜", "服1"
	ELSEIF GROUPMATCH(PAGENUM, 3)
		CALL PRINT_FACE, 38, "愤怒"
	ELSE
		CALL PRINT_FACE, 38
	ENDIF
ENDIF
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
PRINTFORMDL - %CALLNAME:38%的日记　PAGE.{PAGECOUNT} --------------------------------------------------------------------------------------
PRINTL 
;▼简易版ではここから自动で表示されます
CALLFORM DIARY_K38_{PAGENUM}

;==========================================================
;日记の发生条件（@DIARY_NK_K38_YY_HAPPEN）
;RETURN    发生：1なら发生
;RESULT:1  形式：2ならデイリーイベントで读まれる
;                  复数的日记が同时に发生すると番号が小さいものだけが1つ读まれ、それ以外に发生した日记は一旦リセットされる
;                3ならデイリーイベントで读まれない
;                  プレイヤーが自主的に读まない限り读まれない
;                  发生した时点で书き込まれ、复数发生すると复数书き込まれる
;                0は读めない,1は既读なので设定しないように
;RESULT:2  リピート：1を入れると同じ日记が繰り返し书き込まれる
;                    その日だけ有效なフラグ（TCVARやTFLAGなど）を使って条件をつけないと大量に书き込まれるので注意
;
;特定のコマンドやイベント时に日记を发生させたい场合は直接その口上内で"DIARY:38:YY = 2"を加えてください
;"DIARY:38:YY = 3"にしたい场合は以下の命令も合わせてください
;"CALL CHARA_DIARY_PAGESETTING(38, YY)"
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
;日记の内容（@DIARY_NK_K38_YY）
;PRINT命令だけでオッケー
;==========================================================
@DIARY_NK_K38_1_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_1
PRINTFORML 
;==========================================================
@DIARY_NK_K38_2_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_2
PRINTFORML 
;==========================================================
@DIARY_NK_K38_3_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_3
PRINTFORML 
;==========================================================
@DIARY_NK_K38_4_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_4
PRINTFORML 
;==========================================================
@DIARY_NK_K38_5_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_5
PRINTFORML 
;==========================================================
@DIARY_NK_K38_6_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_6
PRINTFORML 
;==========================================================
@DIARY_NK_K38_7_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_7
PRINTFORML 
;==========================================================
@DIARY_NK_K38_8_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_8
PRINTFORML 
;==========================================================
@DIARY_NK_K38_9_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_9
PRINTFORML 
;==========================================================
@DIARY_NK_K38_10_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 3
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_10
PRINTFORML 
;==========================================================

;==========================================================
;▼ページを增やすなら以下のテンプレをコピペしてXとYYを代入してください
[SKIPSTART]
;==========================================================
@DIARY_NK_K38_YY_HAPPEN
;デイリーで读まれるなら2,读まれないなら3
RESULT:1 = 
;リピートするなら1,しないなら0
RESULT:2 = 0
;条件を设定する
SIF 0
	RETURN 1
;－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
@DIARY_NK_K38_YY
PRINTFORML 
;==========================================================
[SKIPEND]

;=============================
;406,日记を读む
;コマンド口上
;TFLAG:不影响SOURCE等的SELECTCOM的分岐（谁的日记を读んでいるか）
;TFLAG:不影响SOURCE等的SELECTCOM的分岐が38でない场合は他人的日记なので注意。
;PAGEは书かれてあるページ数。
;SHIRAHU(38)はキャラ38の状态が正常かどうか。
;=============================
@M_KOJO_NK_MESSAGE_COM_K38_406
CALL M_KOJO_NK_MESSAGE_COM_K38_406_1
RETURN RESULT

@M_KOJO_NK_MESSAGE_COM_K38_406_1
IF SHIRAHU(38) && TFLAG:不影响SOURCE等的SELECTCOM的分岐 == 38
	PRINTFORML 「」
ENDIF
