@M_KOJO_IRAI_K129(ROLE, SCENE, IRAI_ID)
#DIMS ROLE     ;キャラの立场、依赖者かそうでないか
#DIMS SCENE    ;セリフの表示されるタイミング
#DIM  IRAI_ID  ;依赖自体のID
#DIM  CLIENT_ID;依赖者IDだけ抜き出したもの
#DIM  CHK_ID   ;依赖IDだけ抜き出したもの
CHK_ID    = IRAI_ID % 1000
CLIENT_ID = IRAI_ID_TO_CLIENT(IRAI_ID)
SELECTCASE ROLE
CASE "CLIENT"
	;一般依赖
	IF IS_COMMON_IRAI(IRAI_ID)
		SELECTCASE STR_DATA_IRAI(IRAI_ID, "依赖名", CLIENT_ID)
		CASE "一般依赖名"
			SELECTCASE SCENE
			CASE "依赖提示时"
			;依赖を持ちかけられる时
			CASE "依赖非受託时"
			;内容だけ見て受託しなかった时
			CASE "依赖受託时"
			;依赖を受託した时
			CASE "依赖确认时"
			;[366]で依赖内容を依赖人に确认した时
			CASE "依赖破棄时"
			;受託した依赖を破棄する时
			CASE "依赖実行直前"
			;[367]で依赖を実行する时、実行处理の前に呼び出される
			CASE "依赖実行直后"
			;[367]で依赖を実行する时、実行处理の后に呼び出される
			CASE "成功報告时"
			;報告时（成功）
			CASE "失敗報告时"
			;報告时（失敗）
			;この他、報告忘れや期限切れで失敗扱いになり后日依赖人に遭遇した際にも表示
			ENDSELECT
		ENDSELECT
		RETURN
	ENDIF
	
	;固有依赖
	SELECTCASE STR_DATA_IRAI(IRAI_ID, "依赖名", CLIENT_ID)
	;個々の依赖名で分岐
	;SCENEのWAITに関する仕様
	;WAIT无しでよい　　　　："依赖提示时", "依赖非受託时", "依赖确认时", "依赖破棄时", "成功報告时", "失敗報告时"
	;
	;以下の2つは実際にはCARRYOUTでの地の文处理との比較検討が必要
	;WAITを入れたほうが適切："依赖実行直前", "依赖実行直后"
	CASE "固有依赖名"
		SELECTCASE SCENE
		CASE "依赖提示时"
		;依赖を持ちかけられる时
		CASE "依赖非受託时"
		;内容だけ見て受託しなかった时
		CASE "依赖受託时"
		;依赖を受託した时
		CASE "依赖确认时"
		;[366]で依赖内容を依赖人に确认した时
		CASE "依赖破棄时"
		;受託した依赖を破棄する时
		CASE "依赖実行直前"
		;[367]で依赖を実行する时、実行处理の前に呼び出される
		CASE "依赖実行直后"
		;[367]で依赖を実行する时、実行处理の后に呼び出される
		CASE "成功報告时"
		;報告时（成功）
		CASE "失敗報告时"
		;報告时（失敗）
		;この他、報告忘れや期限切れで失敗扱いになり后日依赖人に遭遇した際にも表示
		ENDSELECT
	ENDSELECT
CASE "TARGET"
	;ここで表示されるSCENEは"依赖実行直前", "依赖実行直后"だけです
	;一般依赖
	IF IS_COMMON_IRAI(IRAI_ID)
		SELECTCASE STR_DATA_IRAI(IRAI_ID, "依赖名", CLIENT_ID)
		;個々の依赖名で分岐してください
		CASE "一般依赖名"
		;人物が鍵になっていた・もしくは场所にたまたま居合わせた
			SELECTCASE SCENE
			;TARGETが呼ばれるのはこのタイミングだけ
			CASE "依赖実行直前"
			CASE "依赖実行直后"
			ENDSELECT
		ENDSELECT
		RETURN
	ENDIF
	SELECTCASE CSVCALLNAME(CLIENT_ID)
	;依赖者のCALLNAMEによる分岐（CSV準拠）
	CASE "依赖者"
		SELECTCASE STR_DATA_IRAI(IRAI_ID, "依赖名", CLIENT_ID)
		CASE "固有依赖名"
			SELECTCASE SCENE
			CASE "依赖実行直前"
			CASE "依赖実行直后"
			ENDSELECT
		ENDSELECT
	ENDSELECT
CASE "NO_REPORT"
	;日数経過时、報告不要依赖を达成していた场合に呼ばれる口上
	;ここで表示されるSCENEは"依赖報告不要"だけです
	;SCENEが一つしか无いので分岐は不要
	;また、必ず依赖主の口上が呼ばれます
	;一般依赖
	IF IS_COMMON_IRAI(IRAI_ID)
		SELECTCASE STR_DATA_IRAI(IRAI_ID, "依赖名", CLIENT_ID)
		;個々の依赖名で分岐してください
		CASE "一般依赖名"
		CASE "お花に水をあげて"
		CASE "誰かの落とし物"
		ENDSELECT
		RETURN
	ENDIF
	SELECTCASE STR_DATA_IRAI(IRAI_ID, "依赖名", CLIENT_ID)
	CASE "固有依赖名"
	ENDSELECT
ENDSELECT
