# 關鍵詞觸發系統使用指南

## 📋 功能概述

關鍵詞觸發系統允許伺服器管理員設定自定義的關鍵詞和回覆。當用戶發送匹配的關鍵詞時，機器人會自動回覆預設的內容。

## 👑 管理員權限

以下用戶可以管理關鍵詞：
- ✅ **伺服器擁有者**（Server Owner）
- ✅ **擁有「管理員」權限的成員**

## 🎯 功能特點

- ✅ **伺服器獨立**：每個伺服器的關鍵詞互不影響
- ✅ **完全匹配**：只有完全匹配的訊息才會觸發
- ✅ **即時生效**：添加後立即可用
- ✅ **持久化存儲**：重啟機器人後配置不會丟失

## 📝 使用命令

### 1. 添加關鍵詞

```
/keyword add
```

執行此命令後，會彈出一個表單讓你填寫：
- **關鍵詞**：要觸發的關鍵詞（必須完全匹配）
- **回覆內容**：機器人的回覆內容（支援多行文字）

**使用步驟：**
1. 輸入 `/keyword add` 並按下 Enter
2. 在彈出的表單中填寫關鍵詞和回覆內容
3. 點擊「提交」按鈕

**示例：**
- 關鍵詞：`規則`
- 回覆內容：
  ```
  請遵守伺服器規則：
  1. 禁止廣告
  2. 禁止辱罵
  3. 保持友善
  ```

### 2. 列出所有關鍵詞

```
/keyword list
```

顯示當前伺服器的所有關鍵詞和回覆內容。

### 3. 刪除或修改關鍵詞

如需刪除或修改關鍵詞，請直接編輯 `server_keywords.json` 文件：

1. 停止機器人
2. 編輯 `server_keywords.json`
3. 重新啟動機器人

**為什麼移除了 `/keyword remove` 和 `/keyword clear` 指令？**
- 避免管理員不小心刪除重要關鍵詞
- 直接編輯 JSON 文件更安全且可以備份
- 可以批量修改多個關鍵詞

### 4. 刪除關鍵詞回覆訊息 🆕

**使用方式：**
1. 右鍵點擊機器人的關鍵詞回覆訊息
2. 選擇「刪除此回覆」
3. 在確認對話框中點擊「確認刪除」或「取消」

**權限要求：**
- ✅ 觸發該關鍵詞的用戶可以刪除
- ✅ 伺服器管理員可以刪除任何回覆

**注意事項：**
- 此操作只刪除訊息，不會影響關鍵詞配置
- 下次觸發相同關鍵詞時仍會回覆
- 確認對話框 30 秒後自動失效
- 只有發起刪除請求的用戶才能確認操作

## 🔍 觸發規則

### 完全匹配

關鍵詞必須**完全匹配**才會觸發：

✅ **會觸發：**
- 用戶發送：`你好`
- 關鍵詞：`你好`
- 結果：✅ 觸發

❌ **不會觸發：**
- 用戶發送：`你好啊`
- 關鍵詞：`你好`
- 結果：❌ 不觸發（不完全匹配）

- 用戶發送：`大家好`
- 關鍵詞：`你好`
- 結果：❌ 不觸發（不完全匹配）

### 大小寫敏感

關鍵詞區分大小寫：

- 關鍵詞：`Hello`
- 用戶發送：`hello` → ❌ 不觸發
- 用戶發送：`Hello` → ✅ 觸發

## 📊 使用示例

### 示例 1：設定歡迎訊息

```
/keyword add keyword:新人報到 response:歡迎新朋友！請先閱讀 #規則 頻道，然後到 #自我介紹 介紹自己吧！
```

當新成員發送「新人報到」時，機器人會自動回覆歡迎訊息。

### 示例 2：常見問題解答

```
/keyword add keyword:如何加入語音? response:點擊左側的語音頻道即可加入！
/keyword add keyword:機器人指令 response:使用 /help 查看所有可用指令
/keyword add keyword:伺服器規則 response:請查看 #規則 頻道了解詳細規則
```

### 示例 3：有趣的互動

```
/keyword add keyword:早安 response:早安！今天也要元氣滿滿哦！☀️
/keyword add keyword:晚安 response:晚安～做個好夢！🌙
/keyword add keyword:機器人你好 response:你好！我是你的小助手，有什麼可以幫助你的嗎？
```

## 🗂️ 數據存儲

關鍵詞配置存儲在 `server_keywords.json` 文件中：

```json
{
  "_comment": "伺服器關鍵詞配置文件",
  "_format": {
    "guild_id": {
      "keyword": "response"
    }
  },
  "123456789012345678": {
    "你好": "你好！歡迎！",
    "規則": "請遵守伺服器規則"
  }
}
```

## ⚠️ 注意事項

1. **權限要求**：只有管理員可以添加/刪除關鍵詞
2. **完全匹配**：關鍵詞必須完全匹配才會觸發
3. **不會觸發機器人**：機器人自己的訊息不會觸發關鍵詞
4. **僅限伺服器**：私訊中不會觸發關鍵詞
5. **重複關鍵詞**：同一個關鍵詞不能重複添加，需要先刪除再添加
6. **刪除回覆訊息**：只能刪除訊息本身，不會移除關鍵詞配置
7. **機器人權限**：機器人需要「管理訊息」權限才能刪除訊息

## 🔧 故障排除

### 問題：關鍵詞沒有觸發

**可能原因：**
1. 訊息內容不完全匹配關鍵詞
2. 關鍵詞大小寫不匹配
3. 訊息前後有多餘的空格

**解決方案：**
- 使用 `/keyword list` 檢查關鍵詞是否正確設定
- 確保發送的訊息與關鍵詞完全一致

### 問題：無法添加關鍵詞

**可能原因：**
1. 沒有管理員權限
2. 關鍵詞已存在

**解決方案：**
- 確認你是伺服器擁有者或擁有管理員權限
- 使用 `/keyword list` 檢查關鍵詞是否已存在
- 如需修改，先使用 `/keyword remove` 刪除後再添加

## 📈 最佳實踐

1. **簡短明確**：關鍵詞應該簡短且容易記憶
2. **常用問題**：為常見問題設定關鍵詞可以減少重複回答
3. **定期檢查**：定期使用 `/keyword list` 檢查並清理不需要的關鍵詞
4. **避免衝突**：避免設定過於常見的詞語（如「好」、「是」等）

## 🎨 進階技巧

### 使用 Emoji

```
/keyword add keyword:讚 response:👍 謝謝你的支持！
/keyword add keyword:加油 response:💪 一起加油！
```

### 多行回覆

Discord 支援在回覆中使用換行：

```
/keyword add keyword:規則 response:伺服器規則：
1. 禁止廣告
2. 禁止辱罵
3. 保持友善
```

### 提及頻道

```
/keyword add keyword:公告 response:請查看 <#頻道ID> 獲取最新公告
```

## 📞 技術支援

如有問題或建議，請聯繫伺服器管理員。

---

**版本：** 1.0.0  
**最後更新：** 2025-12-07
